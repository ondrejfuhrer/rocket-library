<% links = ('A'..'Z').to_a.map { |letter| { letter: letter, path: alphabetic_filter_books_path(letter: letter.downcase, params: params.except(:action, :controller)), active: @selected_letter == letter.downcase } } %>
<% links << { letter: 'All', path: books_path, active: @selected_letter.nil? } %>
<div class="row">
  <table class="table table-striped">
    <thead>
    <tr>
      <%= render partial: 'letter_filter_item', collection: links %>
    </tr>
    </thead>
  </table>
</div>
<div class="row">
  <div class="col-sm-7"><h1>Books</h1></div>
  <div class="col-sm-5">
    <%# The path in here can differ (we can have search by the alphabet - different route) #%>
    <%= search_form_for @search, url: request.env['PATH_INFO'] do |s| %>
      <div class="form-group header-margin">
        <div class="row">
          <div class="col-sm-8">
            <%= s.text_field :sku_or_name_cont, placeholder: 'Name, SKU, ...', class: 'form-control' %>
          </div>
          <div class="col-sm-2">
            <%= s.submit 'Search', class: 'btn btn-primary' %>
          </div>
          <div class="col-sm-2">
            <%= link_to 'Clear', books_path, class: 'btn btn-default' %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
<table class="table table-striped">
  <% if @books.empty? %>
    <tr>
      <td><p class="lead text-center">No Books found</p></td>
    </tr>
  <% else %>
    <thead>
    <tr>
      <th></th>
      <th>Name</th>
      <th>Author</th>
      <th>ISBN</th>
      <th>SKU</th>
      <th colspan="4">State</th>
    </tr>
    </thead>
    <tbody>

    <% @books.each do |book| %>
      <%= render partial: 'books_row', locals: { book: book } %>
    <% end %>
    </tbody>
  <% end %>
</table>
<% if can? :create, Book %>
  <%= link_to 'Add a book', new_book_path, :class => 'btn btn-success' %>
<% end %>
<%= render partial: 'books/return_modal', locals: { remote: true } %>